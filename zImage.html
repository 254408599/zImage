<html>
    <head>
        <title>zImage.js</title>
        <meta charset="utf-8">
        <meta author="chelfinn">
        <script src="./js/jquery-v3.2.1.js"></script>
        <script src="./js/zImage.js"></script>
        <style>
            label{
                width: 30px;
                text-align: right;
            }
        </style>
    </head>
<body>
<div>
    <img src="img/garbage.png" style="max-width: 600px; max-height: 600px;" id="img1" />
    <img style="max-width: 600px; max-height: 600px;" id="img2" />
    </br>
    <label>Width:</label><input type="text" name="imgWidth">
    <label>Height:</label><input type="text" name="imgHeight">
    <input type="button" id="Edit" value="缩放">

    <input type="button" id="Rotate" value="旋转">
    </br>

    <label>red:</label><input type="text" name="red">
    <label>green:</label><input type="text" name="green">
    <label>blue:</label><input type="text" name="blue">
    <label>opacity:</label><input type="text" name="opacity">
    <input type="button" id="Filter" value="滤镜">

    <a id="download">下载</a>
    <br/>
</div>
</body>
</html>

<script>
    window.onload=getExif;
    var rotate = 0;
    function getExif() {
        image(rotate);
    }
    $('#Edit').click(function(){
        image(rotate);
    })
    $('#Rotate').click(function(){
        rotate = rotate + 1;
        image(rotate);
    })
    $('#Filter').click(function(){
        image(rotate);
    })
    function image(rotate){
        var width = $('input[name="imgWidth"]').val();
        var height = $('input[name="imgHeight"]').val();
        var red = $('input[name="red"]').val();
        var green = $('input[name="green"]').val();
        var blue = $('input[name="blue"]').val();
        var opacity = $('input[name="opacity"]').val();
        var zImage = $('#img1').zImage({targetId:'myCanvas',rotate:rotate,customWidth:width,customHeight:height});
        zImage.setRed(red);
        zImage.setGreen(green);
        zImage.setBlue(blue);
        zImage.setOpacity(opacity);
        var imgData = zImage.DrawingImg();
        console.log(imgData);
        $('#img2').attr('src',imgData.url);
        $("#download").attr("href", imgData.url).attr('download','aaaa');
    }
</script>